// PrevOutput:  56f87210814c8baef7068454e517a70da2f2103fc3ac7f687e32a228dc80e115 1
// Locked for address: bcrt1qr47dd36u96r0fjle36hdygdnp0v6pwfgzsrl3p
// Vin amount: 1.00000000
// Vout amount: 0.9998848
// PrivKey: cNUnpYpMsJXYCERYBciJnsWBpcYEFjdcbq6dxj4SskGhs7uHuJ7Q
// To address: miCsSagJ7RQDCMcBUaKFKEryaLnxbhGAPt

const bitcoin = require('bitcoinjs-lib')
const TransactionBuilder = bitcoin.TransactionBuilder
const prevTx = '56f87210814c8baef7068454e517a70da2f2103fc3ac7f687e32a228dc80e115'
const address = 'miCsSagJ7RQDCMcBUaKFKEryaLnxbhGAPt'
// const keyPair = fixture.keyPair
const privKey = 'cNUnpYpMsJXYCERYBciJnsWBpcYEFjdcbq6dxj4SskGhs7uHuJ7Q'
const keyPair = bitcoin.ECPair.fromWIF(privKey, bitcoin.networks.testnet)
const p2wpkh = bitcoin.payments.p2wpkh({ pubkey: keyPair.publicKey, network: bitcoin.networks.testnet })
const sequence = 4294967295
const outputValue = 99988480

const txb = new TransactionBuilder(bitcoin.networks.testnet)
txb.setVersion(1)
txb.addInput(prevTx, 1, sequence, p2wpkh.output) // NOTE: provide the prevOutScript!
txb.addOutput(address, outputValue)
txb.sign(0, keyPair, null, null, 100000000) // NOTE: no redeem script

const tx = txb.build()
console.log(`tx.toHex = `, tx.toHex())

// Hex generated with bitcoinjs (spending p2wpkh, ninja ex.)
// 0100000000010115e180dc28a2327e687facc33f10f2a20da717e5548406f7ae8b4c811072f8560100000000ffffffff0100b4f505000000001976a9141d7cd6c75c2e86f4cbf98eaed221b30bd9a0b92888ac02483045022100df7b7e5cda14ddf91290e02ea10786e03eb11ee36ec02dd862fe9a326bbcb7fd02203f5b4496b667e6e281cc654a2da9e4f08660c620a1051337fa8965f727eb19190121038262a6c6cec93c2d3ecd6c6072efea86d02ff8e3328bbd0242b20af3425990ac00000000

// "txid": "d869f854e1f8788bcff294cc83b280942a8c728de71eb709a2c29d10bfe21b7c",
// "hash": "976015741ba2fc60804dd63167326b1a1f7e94af2b66f4a0fd95b38c18ee729b",

//
// 01000000
// 00
// 01
// 01   vinLength
// 15e180dc28a2327e687facc33f10f2a20da717e5548406f7ae8b4c811072f856
// 01000000
// 00           scriptLen
// ffffffff     sequence
// 01           voutLength
// 00b4f50500000000
// 19           scriptPubKeyLen (=25bytes)
// 76a9141d7cd6c75c2e86f4cbf98eaed221b30bd9a0b92888ac
// 02           witnessesLen
// 48           witnessLen (=72bytes)
// 3045022100c340ef900b6f77f2c5f9c3acebd855cfb136a37de51acf01cc9ee595ee75df1902206ed3dd2adbe1877ef05b40cfe34a2a2a0b3b341fdaabdd94ced955953cbb583901
// 21           witnessLen (=33bytes)
// 038262a6c6cec93c2d3ecd6c6072efea86d02ff8e3328bbd0242b20af3425990ac
// 00000000
